{%- include 'modules/stripe/shared/api_credentials' -%}
{%- include 'modules/stripe/shared/constants' -%}
<script>
  const stripe_pk = "{{ context.exports.payments.gateway.public_key }}"
</script>

<script src="https://js.stripe.com/v3/"></script>
<script src="{{ 'modules/stripe/javascripts/StripeAccount.js' | asset_url }}" defer></script>
<script src="{{ 'modules/stripe/javascripts/Collapse.js' | asset_url }}" defer></script>

{%- capture "signature" -%}
  {% include 'modules/payments/shared/calculate_signature', properties: properties, expires_in: expires_in, redirect_to: redirect_to %}
{%- endcapture -%}
<div>

{% if data.gateway_id != blank %}
  {% query_graph "modules/payments/gateway_get", data: data, template: "modules/stripe/get_account" %}
  {% parse_json 'response' %}{{ g.api_call_send.response.body }}{% endparse_json %}
{% endif %}

{% form html-class: 'account-form' %}
  {%- assign text_field = 'modules/stripe/form/inputs/text' -%}
  {%- assign select_field = 'modules/stripe/form/inputs/select' -%}
  {%- assign data_attribute = form_builder.fields.properties.data.name -%}

  {%- include 'modules/stripe/account/status' -%}
  {%- include 'modules/stripe/account/form_data' -%}
  {%- include 'modules/stripe/account/basic_settings' -%}
  {%- include 'modules/stripe/account/external_account' -%}
  {%- include 'modules/stripe/account/individual' -%}
  {%- include 'modules/stripe/account/company' -%}
  {%- include 'modules/stripe/account/persons' -%}
  {%- include 'modules/stripe/account/submit' -%}
{% endform %}


<style type="text/css" media="all">
  .alert-danger:empty{
    display: none;
  }
</style>
